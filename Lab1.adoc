= Отчет
:toc: macro


include::Titul.adoc[]

toc::[]

== Задание 1

После создания проекта с main.cpp, туда был добавлен файл startup.cpp. Далее создадим папки AbstractHardware/Registers/Filed Values, Common. Папка AbstractHardware содержит файлы для работы с регистрами, аппаратурой и периферией. Common

Размер стека (Stack) установили в 0x1000 и кучи (Heap) можно установить в 0, так как динамическая память не будет использоваться.

.Установленные стек и куча
image::Stack and Heap.jpg[]

Скопировали содержимое папки Registers и Common с проекта преподавателя в свою папку.

.main.cpp

[source,ruby]
----
#include "rccregisters.hpp"
#include "gpiocregisters.hpp"

int main()
{
RCC::AHB1ENR::GPIOCEN::Enable::Set();
GPIOC::MODER::MODER5::Output::Set();
GPIOC::ODR::ODR5::High::Set();
GPIOC::ODR::ODR5::Low::Set();
return 0;
}
----

== Задание 2

Скомпоновали программу и откомпилировали.

.Откомпилорованный и скомпанованный проект
image::Откомилированный и скомпанованный проект.jpg[]

После загрузили программу в симмуляторе, установили точку остановы в строчку 6 и прошлись с отладчиком. Результат представлен на рисунке 3.

.Результат пошаговой отладки программы в симмуляторе
image::Sim.jpg[]

Настроили Debugger на отладку через StLink, подключили микроконтроллер к компьютеру и загрузили программу в плату. Выполнили пошаговую отладку, начиная с строчки 6. Шестая строчка кода запускает тактирование порта C, седьмая отправляет порт С.5 на вывод, следующая, седьмая строчка кода включает светодиод, восьмая выключает его, девятая строчка завершает функцию main(), возвращая 0.

== Задание 3

Включили анализатор стека в Linker'е (Enable stack usage analysis).

.Включить/отключить функцию анализатор стека
image::Analyze_stack.jpg[]

В map файле появилась область, указывающая на то, сколько было занято в стеке, в данном случае 16 байт (0x10). Кроме того, в map файле указываются адреса переменных и функций, какой размер они имеют, к какому типу и сегменту они относятся, ошибки и предупреждения, по какому адресу начинается и заканчивается ROM и RAM, диапазон неиспользованных адресов.
Кучу можно поставить в 0, так как в данном случае не использовалась динамическая память. Со стеком можно поступить так же, то есть поставить в 0, так как туда ничего не записывалось, временные переменные не создавались.

== Выводы

В данной работе был создан проект, была проведена пошаговая отладка программы через STLink с микроконтролером и через симмулятор, так же было описано содержимое map файла. Так же была проведена работа со стеком и кучей, которые в данном случае можно поставить в 0.